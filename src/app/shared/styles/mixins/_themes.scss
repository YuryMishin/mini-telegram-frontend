// üåô Theme Mixins –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º–Ω–æ–π/—Å–≤–µ—Ç–ª–æ–π —Ç–µ–º—ã

// –û—Å–Ω–æ–≤–Ω–æ–π –º–∏–∫—Å–∏–Ω –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ü–≤–µ—Ç–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–º—ã
@mixin theme-aware($property, $light-value, $dark-value) {
  #{$property}: #{$light-value};

  .dark & {
    #{$property}: #{$dark-value};
  }
}

// –ú–∏–∫—Å–∏–Ω –¥–ª—è —Ñ–æ–Ω–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ç–µ–º
@mixin theme-background($light-bg, $dark-bg) {
  @include theme-aware(background-color, $light-bg, $dark-bg);
}

// –ú–∏–∫—Å–∏–Ω –¥–ª—è —Ç–µ–∫—Å—Ç–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ç–µ–º
@mixin theme-text($light-text, $dark-text) {
  @include theme-aware(color, $light-text, $dark-text);
}

// –ú–∏–∫—Å–∏–Ω –¥–ª—è –≥—Ä–∞–Ω–∏—Ü —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ç–µ–º
@mixin theme-border($light-border, $dark-border, $width: 1px, $style: solid) {
  border: $width $style $light-border;

  .dark & {
    border-color: $dark-border;
  }
}

// –ú–∏–∫—Å–∏–Ω –¥–ª—è —Ç–µ–Ω–µ–π —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ç–µ–º
@mixin theme-shadow($light-shadow, $dark-shadow) {
  box-shadow: $light-shadow;

  .dark & {
    box-shadow: $dark-shadow;
  }
}

// Telegram —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ç–µ–º—ã
@mixin telegram-message-bubble($is-own: false) {
  @if $is-own {
    // –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
    @include theme-background($telegram-blue, $telegram-blue);
    @include theme-text(white, white);
    border-radius: 18px 18px 4px 18px;
    margin-left: auto;
  } @else {
    // –ß—É–∂–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
    @include theme-background(white, $telegram-dark-surface);
    @include theme-text($telegram-light-border, white);
    @include theme-border($telegram-light-border, $telegram-dark-border);
    border-radius: 18px 18px 18px 4px;
    margin-right: auto;
  }

  padding: 8px 12px;
  max-width: 480px;
  word-wrap: break-word;
  position: relative;
}

// –î–∏–∞–ª–æ–≥ –≤ —Å–ø–∏—Å–∫–µ
@mixin dialog-item-theme() {
  @include theme-background(white, $telegram-dark);
  @include theme-text($telegram-light-border, white);
  @include theme-border(transparent, transparent);
  transition: all 0.2s ease;

  &:hover {
    @include theme-background($telegram-light-hover, $telegram-dark-hover);
  }

  &.selected {
    @include theme-background(rgba($telegram-blue, 0.1), rgba($telegram-blue, 0.2));
    border-left: 4px solid $telegram-blue;
  }
}

// –°–∞–π–¥–±–∞—Ä —Ç–µ–º–∏–∑–∞—Ü–∏—è
@mixin sidebar-theme() {
  @include theme-background($telegram-light, $telegram-dark);
  @include theme-border($telegram-light-border, $telegram-dark-border, 1px, solid);
  border-right: 1px solid;

  .sidebar-header {
    @include theme-background($telegram-light-surface, $telegram-dark-surface);
    @include theme-border(transparent, $telegram-dark-border, 0, none);
    border-bottom: 1px solid;
  }
}

// –•–µ–¥–µ—Ä —á–∞—Ç–∞
@mixin chat-header-theme() {
  @include theme-background($telegram-light, $telegram-dark);
  @include theme-border($telegram-light-border, $telegram-dark-border, 1px, solid);
  border-bottom: 1px solid;

  h1, h2, h3 {
    @include theme-text($telegram-light-border, white);
  }

  .status-text {
    @include theme-text(rgba($telegram-light-border, 0.7), rgba(white, 0.7));
  }
}

// –ü–æ–ª–µ –≤–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
@mixin message-input-theme() {
  .input-container {
    @include theme-background($telegram-light, $telegram-dark);
    @include theme-border($telegram-light-border, $telegram-dark-border, 1px, solid);
    border-top: 1px solid;
    padding: 16px;
  }

  .message-input {
    @include theme-background($telegram-light-surface, $telegram-dark-surface);
    @include theme-text($telegram-light-border, white);
    @include theme-border($telegram-light-border, $telegram-dark-border);
    border-radius: 24px;

    &:focus {
      @include theme-border($telegram-blue, $telegram-blue);
      outline: none;
      box-shadow: 0 0 0 2px rgba($telegram-blue, 0.2);
    }

    &::placeholder {
      @include theme-text(rgba($telegram-light-border, 0.5), rgba(white, 0.5));
    }
  }
}

// –°–∫—Ä–æ–ª–ª–±–∞—Ä —Ç–µ–º–∏–∑–∞—Ü–∏—è
@mixin themed-scrollbar() {
  &::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  &::-webkit-scrollbar-track {
    @include theme-background(transparent, transparent);
  }

  &::-webkit-scrollbar-thumb {
    @include theme-background(rgba($telegram-light-border, 0.3), rgba(white, 0.2));
    border-radius: 3px;

    &:hover {
      @include theme-background(rgba($telegram-light-border, 0.5), rgba(white, 0.3));
    }
  }

  // –î–ª—è Firefox
  scrollbar-width: thin;
  scrollbar-color: rgba($telegram-light-border, 0.3) transparent;

  .dark & {
    scrollbar-color: rgba(white, 0.2) transparent;
  }
}

// –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é
@mixin context-menu-theme() {
  @include theme-background(white, $telegram-dark-surface);
  @include theme-border($telegram-light-border, $telegram-dark-border);
  @include theme-shadow(
      0 4px 6px -1px rgba(0, 0, 0, 0.1),
      0 4px 6px -1px rgba(0, 0, 0, 0.3)
  );
  border-radius: 8px;
  padding: 4px;
  min-width: 160px;

  .menu-item {
    @include theme-text($telegram-light-border, white);
    padding: 8px 12px;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.15s ease;

    &:hover {
      @include theme-background($telegram-light-hover, $telegram-dark-hover);
    }

    &.danger {
      @include theme-text(#dc2626, #f87171);

      &:hover {
        @include theme-background(rgba(#dc2626, 0.1), rgba(#dc2626, 0.2));
      }
    }
  }
}

// –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
@mixin modal-theme() {
  .modal-backdrop {
    background-color: rgba(0, 0, 0, 0.5);

    .dark & {
      background-color: rgba(0, 0, 0, 0.7);
    }
  }

  .modal-content {
    @include theme-background(white, $telegram-dark-surface);
    @include theme-shadow(
        0 20px 25px -5px rgba(0, 0, 0, 0.1),
        0 20px 25px -5px rgba(0, 0, 0, 0.4)
    );
    border-radius: 12px;

    .modal-header {
      @include theme-border(transparent, $telegram-dark-border, 0, none);
      border-bottom: 1px solid;

      h2 {
        @include theme-text($telegram-light-border, white);
      }
    }

    .modal-body {
      @include theme-text($telegram-light-border, rgba(white, 0.9));
    }
  }
}

// –°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
@mixin loading-theme() {
  .skeleton {
    @include theme-background($telegram-light-surface, $telegram-dark-surface);

    &::after {
      background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.4),
          transparent
      );

      .dark & {
        background: linear-gradient(
            90deg,
            transparent,
            rgba(255, 255, 255, 0.1),
            transparent
        );
      }
    }
  }
}

// –£—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ –º–∏–∫—Å–∏–Ω—ã
@mixin glass-morphism($blur: 10px, $opacity: 0.8) {
  backdrop-filter: blur($blur);
  -webkit-backdrop-filter: blur($blur);

  @include theme-background(
      rgba(255, 255, 255, $opacity),
      rgba($telegram-dark, $opacity)
  );

  @include theme-border(
      rgba(255, 255, 255, 0.2),
      rgba(255, 255, 255, 0.1)
  );
}

// Responsive —Ç–µ–º—ã (–¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤)
@mixin mobile-theme-adjustments() {
  @media (max-width: 768px) {
    .message-bubble {
      max-width: calc(100vw - 80px);
    }

    .sidebar {
      @include theme-background($telegram-light, $telegram-dark);
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 50;
      transform: translateX(-100%);
      transition: transform 0.3s ease;

      &.open {
        transform: translateX(0);
      }
    }
  }
}

// –ü–µ—á–∞—Ç—å —Å—Ç–∏–ª–µ–π (–¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ —á–∞—Ç–æ–≤)
@mixin print-theme() {
  @media print {
    * {
      background: white !important;
      color: black !important;
      box-shadow: none !important;
    }

    .sidebar,
    .message-input,
    button:not(.print-button) {
      display: none !important;
    }

    .message-bubble {
      border: 1px solid #ccc !important;
      margin: 4px 0 !important;
    }
  }
}
